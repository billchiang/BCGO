# AFP Conversion Module

## Purpose

This module is responsible for converting Advanced Function Presentation (AFP) documents to other formats, primarily:

*   PDF (Portable Document Format)
*   PDF/A (PDF for Archiving)
*   PCL (Printer Command Language)
*   PostScript (PS)

The module is designed to act as a microservice or a component within a larger document processing system.

## Core Conversion Technology

**This module itself does not implement the low-level AFP conversion logic.** Instead, it is designed to integrate with and wrap a specialized third-party conversion tool. This tool can be a commercial product or a suitable open-source library/tool if one that meets the required fidelity and MO:DCA IS/3 feature support is identified.

The choice of the underlying conversion tool is critical and should be based on the specific requirements for AFP feature support (e.g., fonts, overlays, IOCA images, FS45 color) and target format fidelity, as outlined in the main `AFP_Conversion_Module_Design.md` document.

## General Integration Approach

The integration with the chosen conversion tool can be achieved through one of the following methods:

1.  **Command-Line Interface (CLI) Wrapping:**
    *   The service will construct and execute command-line calls to the external conversion tool.
    *   Output files generated by the tool will be picked up by the service.
    *   Error handling will involve parsing the tool's exit codes and standard error/output streams.
    *   A sample script (`scripts/run_conversion_tool.sh.example`) illustrates this approach.

2.  **Software Development Kit (SDK) Usage:**
    *   If the chosen conversion tool provides a Java SDK (or SDK for another language if the module is implemented differently), the service will use this SDK to perform conversions.
    *   This approach is generally more robust and provides better control and error handling than CLI wrapping.

## Key Configuration Points

The module will require configuration for its operation, typically managed via an `application.properties` file or environment variables. Key configuration items include:

*   **Conversion Tool Path:**
    *   `afp.conversion.tool.executable.path`: Absolute path to the conversion tool's executable (if using CLI).
    *   `afp.conversion.tool.sdk.lib.path`: Path to SDK libraries (if using an SDK).
*   **License Information (if applicable for commercial tools):**
    *   `afp.conversion.tool.license.key`: License key or path to a license file.
    *   `afp.conversion.tool.license.server`: Hostname for a license server, if required.
*   **AFP Resource Directories:**
    *   `afp.resources.font.path`: Path to directories containing AFP FOCA fonts, character sets, and code pages.
    *   `afp.resources.overlay.path`: Path to directories containing AFP overlays (PSEGs).
    *   `afp.resources.pseg.path`: Path to directories containing AFP page segments.
    *   These paths are crucial for the conversion tool to correctly resolve external AFP resources.
*   **Temporary File Storage:**
    *   `afp.conversion.temp.storage.path`: Path for storing temporary files during the conversion process.
*   **Output Settings:**
    *   Default PDF/A compliance level (e.g., `PDF/A-2b`).
    *   Default PCL type.

See `src/main/java/com/example/afpconversion/config/application.properties.example` for more details.

## API

The service will expose an API (e.g., RESTful) to accept conversion requests and return results. This API is defined in the main `AFP_Conversion_Module_Design.md`. Internal classes like `ConversionRequest.java` and `ConversionResult.java` represent the data structures for these interactions.
